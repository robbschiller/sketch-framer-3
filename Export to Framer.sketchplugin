// Export to Framer 3 (ctrl alt cmd f)

(function(){
// Setup
var export_path = "{doc_name}.framer", // This is relative to the saved document's path
    json_filename = 'layers.json',
    DEBUG = true

#import 'sandbox.js'
#import 'sketch-framer.js'

log("ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶")

// Some sanity checks, before we begin:
var error = check_for_errors()

if(error) { // Stop execution and display error
  log(error)
  alert("Make sure to fix these before we can continue:\n\n" + error)
} else { // Let's go
  log("ğŸ’ Framer, here we goâ€¦")

  // Setup
  var ViewsMetadata = new MetadataExtractor()

  // Authorize
  authorize_app_to_save()
  make_export_folder()

  var views = extract_views_from_document()

  for(var i=0; i< [views count]; i++){
    var view = [views objectAtIndex:i]
    export_assets_for_view(view)
    ViewsMetadata.addView(view)
  }

  save_structure_to_json(ViewsMetadata)

  // All done!
  [doc showMessage:"Export Complete"]
}
}())
